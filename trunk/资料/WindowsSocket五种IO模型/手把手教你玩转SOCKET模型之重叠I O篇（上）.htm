<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0036)http://archive.cnblogs.com/a/129726/ -->
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title>手把手教你玩转SOCKET模型之重叠I/O篇（上） - 博客文库 - 博客园</title> 
<link href="./手把手教你玩转SOCKET模型之重叠I O篇（上）_files/archive.css" rel="stylesheet" type="text/css">
<link type="text/css" rel="stylesheet" href="./手把手教你玩转SOCKET模型之重叠I O篇（上）_files/shCore.css">
<link type="text/css" rel="stylesheet" href="./手把手教你玩转SOCKET模型之重叠I O篇（上）_files/shThemeDefault.css">
<script src="./手把手教你玩转SOCKET模型之重叠I O篇（上）_files/jquery.js" type="text/javascript"></script>
<script src="./手把手教你玩转SOCKET模型之重叠I O篇（上）_files/archive.js" type="text/javascript"></script>
</head>
<body>
<div class="top_nav"><a href="http://www.cnblogs.com/">« 博客园首页</a></div>
<div id="wrapper">
<h1 class="contents_header">手把手教你玩转SOCKET模型之重叠I/O篇（上）</h1>
<div class="contents_info">
	作者：<a href="http://www.cnblogs.com/xw885/" target="_blank">萧萧</a>&nbsp;&nbsp;来源：<a href="http://www.cnblogs.com/" target="_blank">博客园</a>&nbsp;&nbsp;发布时间：2005-03-31 22:23&nbsp;&nbsp;阅读：334 次&nbsp;&nbsp;<a href="http://www.cnblogs.com/xw885/articles/129726.html">原文链接</a>&nbsp;&nbsp;
	<a href="javascript:add_to_wz()" class="graylink">[收藏]</a>&nbsp;&nbsp;
</div>
<div class="contents_main">
	<h2><a id="viewpost.ascx_TitleUrl" href="http://blog.csdn.net/piggyxp/archive/2004/09/23/114883.aspx"><font color="#800080">手把手教你玩转SOCKET模型之重叠I/O篇（上）</font></a> </h2>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; TEXT-INDENT: 63pt; mso-char-indent-count: 4.5"><span style="FONT-SIZE: 14pt; COLOR: fuchsia; FONT-FAMILY: 华文彩云">手把手教你玩转<span lang="EN-US">SOCKET</span>模型之重叠<span lang="EN-US">I/O</span>篇<span lang="EN-US"><o:p></o:p></span></span>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b style="mso-bidi-font-weight: normal"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: fuchsia; FONT-FAMILY: Verdana"><o:p>&nbsp;</o:p></span></b>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 18pt; mso-line-height-rule: exactly"><b style="mso-bidi-font-weight: normal"><span style="FONT-SIZE: 9pt; COLOR: fuchsia; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">“</span></b><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">身为一个初学者，时常能体味到初学者入门的艰辛，所以总是想抽空作点什么来尽我所能的帮助那些需要帮助的人。我也希望大家能把自己的所学和他人一起分享，不要去鄙视别人索取时的贪婪，因为最应该被鄙视的是不肯付出时的吝啬。”</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana"><o:p></o:p></span>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 18pt; mso-line-height-rule: exactly"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </span>----- </span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">题记</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana"><span style="mso-spacerun: yes">&nbsp; </span>By PiggyXP(</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">小猪</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">)</span>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; TEXT-INDENT: 158.95pt; LINE-HEIGHT: 18pt; mso-char-indent-count: 15.08; mso-line-height-rule: exactly"><b style="mso-bidi-font-weight: normal"><span style="COLOR: fuchsia; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana; mso-bidi-font-size: 10.5pt">前</span></b><b style="mso-bidi-font-weight: normal"><span lang="EN-US" style="COLOR: fuchsia; FONT-FAMILY: Verdana; mso-bidi-font-size: 10.5pt"><span style="mso-spacerun: yes">&nbsp;&nbsp; </span></span></b><b style="mso-bidi-font-weight: normal"><span style="COLOR: fuchsia; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana; mso-bidi-font-size: 10.5pt">言</span></b><b style="mso-bidi-font-weight: normal"><span lang="EN-US" style="COLOR: fuchsia; FONT-FAMILY: Verdana; mso-bidi-font-size: 10.5pt"> <o:p></o:p></span></b>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; TEXT-INDENT: 8.85pt; LINE-HEIGHT: 18pt; mso-char-indent-count: .98; mso-line-height-rule: exactly"><b style="mso-bidi-font-weight: normal"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: fuchsia; FONT-FAMILY: Verdana"><span style="mso-spacerun: yes">&nbsp; </span></span></b><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">其实我首先应该道歉，因为</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">7</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">月份的时候曾信誓旦旦的说要写一套关于</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">SOCKET</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">所有模型的入门文章以及配套代码，不过没想到后天竟然被美女所迷出去度假了，刚刚回来不久。。。。。。</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">-_-b</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">其实那些模型的配套代码我已经基本写完了，只是没写配套文字，不过我想还是先从稍微难一点的模型写起吧，因为其他模型的入门毕竟要简单一些。</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana"><o:p></o:p></span>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; TEXT-INDENT: 18pt; LINE-HEIGHT: 18pt; mso-line-height-rule: exactly"><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">不过由于也是初学者，疏漏之处还望不吝指正。</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana"><o:p></o:p></span>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; TEXT-INDENT: 18pt; LINE-HEIGHT: 18pt; mso-line-height-rule: exactly"><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">本文凝聚着笔者心血，如要转载，请指明原作者及出处，谢谢！</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">^_^<o:p></o:p></span>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; TEXT-INDENT: 18pt; LINE-HEIGHT: 18pt; mso-line-height-rule: exactly"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">OK, Let’s go !<span style="mso-spacerun: yes">&nbsp; </span>Have fun</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">！</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">! q^_^p<o:p></o:p></span>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 18pt; mso-line-height-rule: exactly"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana"><o:p>&nbsp;</o:p></span>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; TEXT-INDENT: 18pt; LINE-HEIGHT: 18pt; mso-line-height-rule: exactly"><span style="FONT-SIZE: 9pt; COLOR: red; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">本文配套的示例源码下载地址</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: red; FONT-FAMILY: Verdana"><o:p></o:p></span>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt 18.05pt; LINE-HEIGHT: 18pt; mso-line-height-rule: exactly; mso-para-margin-left: 1.72gd"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">(VC.net 2003</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">编写的多客户端</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">MFC</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">代码，配有详尽注释，只是简单的显示一下客户端发来的字符，稍加改进就是个聊天室了</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">)</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">：</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana"><o:p></o:p></span>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; TEXT-INDENT: 18pt; LINE-HEIGHT: 18pt; mso-line-height-rule: exactly"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana"><a href="http://www.haha567.com/PiggyXP/OverlappedModel.rar"><font color="#800080">http://www.haha567.com/PiggyXP/OverlappedModel.rar</font></a><o:p></o:p></span>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; TEXT-INDENT: 18pt; LINE-HEIGHT: 18pt; mso-line-height-rule: exactly"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">(unix</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">系统，千万注意链接大小写</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">)<o:p></o:p></span>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; TEXT-INDENT: 18pt; LINE-HEIGHT: 18pt; mso-line-height-rule: exactly"><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">非常感谢网络版的</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">limin</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">兄弟为我无偿提供的空间，以及在我学习过程中给我的大力帮助与支持，真的非常感谢他，感激涕零啊</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">~~~~~T_T<o:p></o:p></span>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; TEXT-INDENT: 18pt; LINE-HEIGHT: 18pt; mso-line-height-rule: exactly"><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">也欢迎大家光临他的</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">Blog</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">一起讨论网络技术</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana"><o:p></o:p></span>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; TEXT-INDENT: 18pt; LINE-HEIGHT: 18pt; mso-line-height-rule: exactly"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">http://blog.haha567.com/<o:p></o:p></span>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; TEXT-INDENT: 18pt; LINE-HEIGHT: 18pt; mso-line-height-rule: exactly"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana"><o:p>&nbsp;</o:p></span>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; TEXT-INDENT: 18pt; LINE-HEIGHT: 18pt; mso-line-height-rule: exactly"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">(</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">本文假设你已经具备用</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">SOCKET</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">简单模型编程的能力，如果对</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">SOCKET</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">一无所知请关注本系列其他文章</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">)<o:p></o:p></span>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; TEXT-INDENT: 18pt; LINE-HEIGHT: 18pt; mso-line-height-rule: exactly"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana"><o:p>&nbsp;</o:p></span>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 18pt; mso-line-height-rule: exactly"><b style="mso-bidi-font-weight: normal"><span style="FONT-SIZE: 9pt; COLOR: purple; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">目录：</span></b><b style="mso-bidi-font-weight: normal"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: purple; FONT-FAMILY: Verdana"><o:p></o:p></span></b>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt 18pt; TEXT-INDENT: -18pt; LINE-HEIGHT: 18pt; mso-line-height-rule: exactly; mso-list: l3 level1 lfo5; tab-stops: list 18.0pt"><b style="mso-bidi-font-weight: normal"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: purple; FONT-FAMILY: Verdana; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><span style="mso-list: Ignore">1．<span style="FONT: 7pt &#39;Times New Roman&#39;"> </span></span></span></b><b style="mso-bidi-font-weight: normal"><span style="FONT-SIZE: 9pt; COLOR: purple; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">重叠模型的优点</span></b><b style="mso-bidi-font-weight: normal"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: purple; FONT-FAMILY: Verdana"><o:p></o:p></span></b>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt 18pt; TEXT-INDENT: -18pt; LINE-HEIGHT: 18pt; mso-line-height-rule: exactly; mso-list: l3 level1 lfo5; tab-stops: list 18.0pt"><b style="mso-bidi-font-weight: normal"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: purple; FONT-FAMILY: Verdana; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><span style="mso-list: Ignore">2．<span style="FONT: 7pt &#39;Times New Roman&#39;"> </span></span></span></b><b style="mso-bidi-font-weight: normal"><span style="FONT-SIZE: 9pt; COLOR: purple; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">重叠模型的基本原理</span></b><b style="mso-bidi-font-weight: normal"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: purple; FONT-FAMILY: Verdana"><o:p></o:p></span></b>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt 18pt; TEXT-INDENT: -18pt; LINE-HEIGHT: 18pt; mso-line-height-rule: exactly; mso-list: l3 level1 lfo5; tab-stops: list 18.0pt"><b style="mso-bidi-font-weight: normal"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: purple; FONT-FAMILY: Verdana; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><span style="mso-list: Ignore">3．<span style="FONT: 7pt &#39;Times New Roman&#39;"> </span></span></span></b><b style="mso-bidi-font-weight: normal"><span style="FONT-SIZE: 9pt; COLOR: purple; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">关于重叠模型的基础知识</span></b><b style="mso-bidi-font-weight: normal"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: purple; FONT-FAMILY: Verdana"><o:p></o:p></span></b>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt 18pt; TEXT-INDENT: -18pt; LINE-HEIGHT: 18pt; mso-line-height-rule: exactly; mso-list: l3 level1 lfo5; tab-stops: list 18.0pt"><b style="mso-bidi-font-weight: normal"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: purple; FONT-FAMILY: Verdana; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><span style="mso-list: Ignore">4．<span style="FONT: 7pt &#39;Times New Roman&#39;"> </span></span></span></b><b style="mso-bidi-font-weight: normal"><span style="FONT-SIZE: 9pt; COLOR: purple; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">重叠模型的实现步骤</span></b><b style="mso-bidi-font-weight: normal"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: purple; FONT-FAMILY: Verdana"><o:p></o:p></span></b>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt 18pt; TEXT-INDENT: -18pt; LINE-HEIGHT: 18pt; mso-line-height-rule: exactly; mso-list: l3 level1 lfo5; tab-stops: list 18.0pt"><b style="mso-bidi-font-weight: normal"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: purple; FONT-FAMILY: Verdana; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><span style="mso-list: Ignore">5．<span style="FONT: 7pt &#39;Times New Roman&#39;"> </span></span></span></b><b style="mso-bidi-font-weight: normal"><span style="FONT-SIZE: 9pt; COLOR: purple; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">多客户端情况的注意事项</span></b><b style="mso-bidi-font-weight: normal"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: purple; FONT-FAMILY: Verdana"><o:p></o:p></span></b>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 18pt; mso-line-height-rule: exactly"><b style="mso-bidi-font-weight: normal"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: fuchsia; FONT-FAMILY: Verdana"><o:p>&nbsp;</o:p></span></b>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 18pt; mso-line-height-rule: exactly"><b style="mso-bidi-font-weight: normal"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: fuchsia; FONT-FAMILY: Verdana"><o:p>&nbsp;</o:p></span></b>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt 18pt; TEXT-INDENT: -18pt; LINE-HEIGHT: 18pt; mso-line-height-rule: exactly; mso-list: l2 level1 lfo1; tab-stops: list 18.0pt"><b style="mso-bidi-font-weight: normal"><span lang="EN-US" style="COLOR: fuchsia; FONT-FAMILY: Verdana; mso-bidi-font-size: 10.5pt; mso-bidi-font-family: 宋体"><span style="mso-list: Ignore">一．<span style="FONT: 7pt &#39;Times New Roman&#39;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></b><b style="mso-bidi-font-weight: normal"><span style="COLOR: fuchsia; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana; mso-bidi-font-size: 10.5pt">重叠模型的优点</span></b><b style="mso-bidi-font-weight: normal"><span lang="EN-US" style="COLOR: fuchsia; FONT-FAMILY: Verdana; mso-bidi-font-size: 10.5pt"><o:p></o:p></span></b>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt 27pt; TEXT-INDENT: -18pt; LINE-HEIGHT: 18pt; mso-line-height-rule: exactly; mso-list: l1 level1 lfo2; tab-stops: list 27.0pt"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><span style="mso-list: Ignore">1.<span style="FONT: 7pt &#39;Times New Roman&#39;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">可以运行在支持</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">Winsock2</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">的所有</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">Windows</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">平台</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana"> ,</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">而不像完成端口只是支持</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">NT</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">系统。</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana"><o:p></o:p></span>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt 27pt; TEXT-INDENT: -18pt; LINE-HEIGHT: 18pt; mso-line-height-rule: exactly; mso-list: l1 level1 lfo2; tab-stops: list 27.0pt"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><span style="mso-list: Ignore">2.<span style="FONT: 7pt &#39;Times New Roman&#39;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">比起阻塞、</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">select</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">、</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">WSAAsyncSelect</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">以及</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">WSAEventSelect</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">等模型，重叠</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">I/O(Overlapped I/O)</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">模型使应用程序能达到更佳的系统性能。</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana"><o:p></o:p></span>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt 27.05pt; TEXT-INDENT: -18pt; LINE-HEIGHT: 18pt; mso-char-indent-count: -2.0; mso-line-height-rule: exactly; mso-para-margin-left: .86gd"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">因为它和这</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">4</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">种模型不同的是，使用重叠模型的应用程序通知缓冲区收发系统直接使用数据，也就是说，如果应用程序投递了一个</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">10KB</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">大小的缓冲区来接收数据，且数据已经到达套接字，则该数据将直接被拷贝到投递的缓冲区。</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana"><o:p></o:p></span>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt 27.1pt; TEXT-INDENT: 22.5pt; LINE-HEIGHT: 18pt; mso-char-indent-count: 2.5; mso-line-height-rule: exactly; mso-para-margin-left: 2.58gd"><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">而这</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">4</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">种模型种，数据到达并拷贝到单套接字接收缓冲区中，此时应用程序会被告知可以读入的容量。当应用程序调用接收函数之后，数据才从单套接字缓冲区拷贝到应用程序的缓冲区，差别就体现出来了。</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana"><o:p></o:p></span>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt 27pt; TEXT-INDENT: -18pt; LINE-HEIGHT: 18pt; mso-line-height-rule: exactly; mso-list: l1 level1 lfo2; tab-stops: list 27.0pt"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><span style="mso-list: Ignore">3.<span style="FONT: 7pt &#39;Times New Roman&#39;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">从《</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">windows</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">网络编程》中提供的试验结果中可以看到，在使用了</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">P4 <st1:chmetcnv w:st="on" tcsc="0" numbertype="1" negative="False" hasspace="False" sourcevalue="1.7" unitname="g">1.7G</st1:chmetcnv> Xero</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">处理器</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">(CPU</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">很强啊</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">)</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">以及</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">768MB</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">的回应服务器中，最大可以处理</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">4</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">万多个</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">SOCKET</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">连接，在处理</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">1</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">万</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">2</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">千个连接的时候</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">CPU</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">占用率才</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">40% </span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">左右</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana"> </span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">――</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana"> </span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">非常好的性能，已经直逼完成端口了</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">^_^<o:p></o:p></span>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt 9pt; LINE-HEIGHT: 18pt; mso-line-height-rule: exactly"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></span>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 18pt; mso-line-height-rule: exactly"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana"><o:p>&nbsp;</o:p></span>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt 18pt; TEXT-INDENT: -18pt; LINE-HEIGHT: 18pt; mso-line-height-rule: exactly; mso-list: l2 level1 lfo1; tab-stops: list 18.0pt"><b style="mso-bidi-font-weight: normal"><span lang="EN-US" style="COLOR: fuchsia; FONT-FAMILY: Verdana; mso-bidi-font-size: 10.5pt; mso-bidi-font-family: 宋体"><span style="mso-list: Ignore">二．<span style="FONT: 7pt &#39;Times New Roman&#39;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></b><b style="mso-bidi-font-weight: normal"><span style="COLOR: fuchsia; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana; mso-bidi-font-size: 10.5pt">重叠模型的基本原理</span></b><b style="mso-bidi-font-weight: normal"><span lang="EN-US" style="COLOR: fuchsia; FONT-FAMILY: Verdana; mso-bidi-font-size: 10.5pt"><o:p></o:p></span></b>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 18pt; mso-line-height-rule: exactly"><b style="mso-bidi-font-weight: normal"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: fuchsia; FONT-FAMILY: Verdana"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">说了这么多的好处，你一定也跃跃欲试了吧，不过我们还是要先提一下重叠模型的基本原理。</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana"><o:p></o:p></span>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 18pt; mso-line-height-rule: exactly"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">概括一点说，重叠模型是让应用程序使用重叠数据结构</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">(WSAOVERLAPPED)</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">，一次投递一个或多个</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">Winsock I/O</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">请求。针对这些提交的请求，在它们完成之后，应用程序会收到通知，于是就可以通过自己另外的代码来处理这些数据了。</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana"><o:p></o:p></span>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 18pt; mso-line-height-rule: exactly"><b style="mso-bidi-font-weight: normal"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: fuchsia; FONT-FAMILY: Verdana"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">需要注意的是，有两个方法可以用来管理重叠</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">IO</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">请求的完成情况（就是说接到重叠操作完成的通知）：</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana"><o:p></o:p></span>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt 45pt; TEXT-INDENT: -18pt; LINE-HEIGHT: 18pt; mso-line-height-rule: exactly; mso-list: l4 level1 lfo3; tab-stops: list 45.0pt"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><span style="mso-list: Ignore">1.<span style="FONT: 7pt &#39;Times New Roman&#39;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">事件对象通知</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">(event object notification) <o:p></o:p></span>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt 45pt; TEXT-INDENT: -18pt; LINE-HEIGHT: 18pt; mso-line-height-rule: exactly; mso-list: l4 level1 lfo3; tab-stops: list 45.0pt"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><span style="mso-list: Ignore">2.<span style="FONT: 7pt &#39;Times New Roman&#39;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">完成例程</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">(completion routines) ,</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">注意，这里并不是完成端口</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana"><o:p></o:p></span>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt 8.9pt; TEXT-INDENT: 18pt; LINE-HEIGHT: 18pt; mso-char-indent-count: 2.0; mso-line-height-rule: exactly; mso-para-margin-left: .85gd"><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">而</span><span style="FONT-SIZE: 9pt; COLOR: fuchsia; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">本文只是讲述如何来使用事件通知的的方法实现重叠</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: fuchsia; FONT-FAMILY: Verdana">IO</span><span style="FONT-SIZE: 9pt; COLOR: fuchsia; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">模型，</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">完成例程的方法准备放到下一篇讲</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana"> </span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">：）</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana"> (</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">内容太多了，一篇写不完啊</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">) </span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">，如没有特殊说明，本文的重叠模型默认就是指的基于事件通知的重叠模型。</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana"><o:p></o:p></span>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt 8.9pt; TEXT-INDENT: 18pt; LINE-HEIGHT: 18pt; mso-char-indent-count: 2.0; mso-line-height-rule: exactly; mso-para-margin-left: .85gd"><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">既然是基于事件通知，就要求将</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">Windows</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">事件对象与</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">WSAOVERLAPPED</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">结构关联在一起（</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">WSAOVERLAPPED</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">结构中专门有对应的参数），通俗一点讲，就是。。。。对了，忘了说了，既然要使用重叠结构，我们常用的</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">send, sendto, recv, recvfrom</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">也都要被</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">WSASend, WSASendto, WSARecv, WSARecvFrom</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">替换掉了，</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana"> </span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">它们的用法我后面会讲到，这里只需要注意一点，它们的参数中都有一个</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">Overlapped</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">参数，我们可以假设是把我们的</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">WSARecv</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">这样的操作操作“绑定”到这个重叠结构上，提交一个请求，其他的事情就交给重叠结构去操心，而其中重叠结构又要与</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">Windows</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">的事件对象“绑定”在一起，这样我们调用完</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">WSARecv</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">以后就可以“坐享其成”，等到重叠操作完成以后，自然会有与之对应的事件来通知我们操作完成，然后我们就可以来根据重叠操作的结果取得我们想要德数据了。</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana"> <span lang="EN-US"><o:p></o:p></span></span>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 18pt; mso-line-height-rule: exactly"><b style="mso-bidi-font-weight: normal"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: fuchsia; FONT-FAMILY: Verdana"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">也许说了半天你还是不大明白，那就继续往后面看吧。。。。。。。</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">-_-b</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">，语言表达能力有限啊</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">~~~<o:p></o:p></span>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 18pt; mso-line-height-rule: exactly"><b style="mso-bidi-font-weight: normal"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: fuchsia; FONT-FAMILY: Verdana"><o:p>&nbsp;</o:p></span></b>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 18pt; mso-line-height-rule: exactly"><b style="mso-bidi-font-weight: normal"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: fuchsia; FONT-FAMILY: Verdana"><o:p>&nbsp;</o:p></span></b>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt 18pt; TEXT-INDENT: -18pt; LINE-HEIGHT: 18pt; mso-line-height-rule: exactly; mso-list: l2 level1 lfo1; tab-stops: list 18.0pt"><b style="mso-bidi-font-weight: normal"><span lang="EN-US" style="COLOR: fuchsia; FONT-FAMILY: Verdana; mso-bidi-font-size: 10.5pt; mso-bidi-font-family: 宋体"><span style="mso-list: Ignore">三．<span style="FONT: 7pt &#39;Times New Roman&#39;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></b><b style="mso-bidi-font-weight: normal"><span style="COLOR: fuchsia; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana; mso-bidi-font-size: 10.5pt">关于重叠模型的基础知识</span></b><b style="mso-bidi-font-weight: normal"><span lang="EN-US" style="COLOR: fuchsia; FONT-FAMILY: Verdana; mso-bidi-font-size: 10.5pt"><o:p></o:p></span></b>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 18pt; mso-line-height-rule: exactly"><b style="mso-bidi-font-weight: normal"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: fuchsia; FONT-FAMILY: Verdana"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">下面来介绍并举例说明一下编写重叠模型的程序中将会使用到的几个关键函数。</span><b style="mso-bidi-font-weight: normal"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: fuchsia; FONT-FAMILY: Verdana"><o:p></o:p></span></b>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt 22.5pt; TEXT-INDENT: -18pt; LINE-HEIGHT: 18pt; mso-line-height-rule: exactly; mso-list: l0 level1 lfo4; tab-stops: list 22.5pt"><b style="mso-bidi-font-weight: normal"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #ff6600; FONT-FAMILY: Verdana; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><span style="mso-list: Ignore">1.<span style="FONT: 7pt &#39;Times New Roman&#39;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></b><b style="mso-bidi-font-weight: normal"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #ff6600; FONT-FAMILY: Verdana">WSAOVERLAPPED</span></b><b style="mso-bidi-font-weight: normal"><span style="FONT-SIZE: 9pt; COLOR: #ff6600; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">结构</span></b><b style="mso-bidi-font-weight: normal"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #ff6600; FONT-FAMILY: Verdana"><o:p></o:p></span></b>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt 22.45pt; TEXT-INDENT: 4.5pt; LINE-HEIGHT: 18pt; mso-char-indent-count: .5; mso-line-height-rule: exactly; mso-para-margin-left: 2.14gd"><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">这个结构自然是重叠模型里的核心，它是这么定义的</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana"><o:p></o:p></span>
</p><pre style="BACKGROUND: #dddddd; MARGIN-LEFT: 44.9pt; TEXT-INDENT: -44.9pt; LINE-HEIGHT: 15pt; mso-char-indent-count: -4.97; mso-line-height-rule: exactly"><b style="mso-bidi-font-weight: normal"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: Verdana; mso-fareast-font-family: 新宋体"><font style="BACKGROUND-COLOR: #dddddd">typedef struct _WSAOVERLAPPED</font></span></b><font style="BACKGROUND-COLOR: #dddddd"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #993300; FONT-FAMILY: Verdana; mso-fareast-font-family: 新宋体"> {
<br>
<span style="mso-spacerun: yes">&nbsp; </span></span><b style="mso-bidi-font-weight: normal"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: Verdana; mso-fareast-font-family: 新宋体">DWORD</span></b><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #993300; FONT-FAMILY: Verdana; mso-fareast-font-family: 新宋体"> </span><i style="mso-bidi-font-style: normal"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana; mso-fareast-font-family: 新宋体"><span style="mso-field-code: &#39; HYPERLINK &#39;&#39;&#39;">Internal</span>;</span></i></font><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #993300; FONT-FAMILY: Verdana; mso-fareast-font-family: 新宋体">
<br>
<span style="mso-spacerun: yes"><font style="BACKGROUND-COLOR: #dddddd">&nbsp;</font></span></span><font style="BACKGROUND-COLOR: #dddddd"><b style="mso-bidi-font-weight: normal"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: Verdana; mso-fareast-font-family: 新宋体"><span style="mso-spacerun: yes">&nbsp;</span>DWORD</span></b><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #993300; FONT-FAMILY: Verdana; mso-fareast-font-family: 新宋体"> </span><i style="mso-bidi-font-style: normal"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana; mso-fareast-font-family: 新宋体"><span style="mso-field-code: &#39; HYPERLINK &#39;&#39;&#39;">InternalHigh</span>;</span></i></font><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #993300; FONT-FAMILY: Verdana; mso-fareast-font-family: 新宋体">
<br>
<span style="mso-spacerun: yes"><font style="BACKGROUND-COLOR: #dddddd">&nbsp; </font></span></span><font style="BACKGROUND-COLOR: #dddddd"><b style="mso-bidi-font-weight: normal"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: Verdana; mso-fareast-font-family: 新宋体">DWORD</span></b><i style="mso-bidi-font-style: normal"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana; mso-fareast-font-family: 新宋体"> <span style="mso-field-code: &#39; HYPERLINK &#39;&#39;&#39;">Offset</span>;</span></i></font><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #993300; FONT-FAMILY: Verdana; mso-fareast-font-family: 新宋体">
<br>
<span style="mso-spacerun: yes"><font style="BACKGROUND-COLOR: #dddddd">&nbsp; </font></span></span><font style="BACKGROUND-COLOR: #dddddd"><b style="mso-bidi-font-weight: normal"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: Verdana; mso-fareast-font-family: 新宋体">DWORD</span></b><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #993300; FONT-FAMILY: Verdana; mso-fareast-font-family: 新宋体"> </span><i style="mso-bidi-font-style: normal"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana; mso-fareast-font-family: 新宋体"><span style="mso-field-code: &#39; HYPERLINK &#39;&#39;&#39;">OffsetHigh</span>;</span></i></font><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #993300; FONT-FAMILY: Verdana; mso-fareast-font-family: 新宋体">
<br>
<span style="mso-spacerun: yes"><font style="BACKGROUND-COLOR: #dddddd">&nbsp; </font></span></span><font style="BACKGROUND-COLOR: #dddddd"><b style="mso-bidi-font-weight: normal"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: Verdana; mso-fareast-font-family: 新宋体">WSAEVENT</span></b><i style="mso-bidi-font-style: normal"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana; mso-fareast-font-family: 新宋体"> <span style="mso-field-code: &#39; HYPERLINK &#39;&#39;&#39;">hEvent</span>;</span></i><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #993300; FONT-FAMILY: Verdana; mso-fareast-font-family: 新宋体"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-fareast-font-family: 新宋体">// </span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 新宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">唯一需要关注的参数，用来关联</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-fareast-font-family: 新宋体">WSAEvent</span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 新宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">对象</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #993300; FONT-FAMILY: Verdana; mso-fareast-font-family: 新宋体"><o:p></o:p></span></font></pre><pre style="BACKGROUND: #dddddd; TEXT-INDENT: 22.15pt; LINE-HEIGHT: 15pt; mso-char-indent-count: 2.46; mso-line-height-rule: exactly"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #993300; FONT-FAMILY: Verdana; mso-fareast-font-family: 新宋体; mso-bidi-font-family: 宋体"><font style="BACKGROUND-COLOR: #dddddd">       } WSAOVERLAPPED, *LPWSAOVERLAPPED;<o:p></o:p></font></span></pre><pre style="BACKGROUND: #dddddd; TEXT-INDENT: 18pt; LINE-HEIGHT: 15pt; mso-char-indent-count: 2.0; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 新宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana; mso-bidi-font-family: 宋体">我们需要把</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana; mso-fareast-font-family: 新宋体; mso-bidi-font-family: 宋体">WSARecv</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 新宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana; mso-bidi-font-family: 宋体">等操作投递到一个重叠结构上，而我们又需要一个与重叠结构“绑定”在一起的事件对象来通知我们操作的完成，看到了和</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana; mso-fareast-font-family: 新宋体; mso-bidi-font-family: 宋体">hEvent</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 新宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana; mso-bidi-font-family: 宋体">参数，不用我说你们也该知道如何来来把事件对象绑定到重叠结构上吧？大致如下：</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana; mso-fareast-font-family: 新宋体; mso-bidi-font-family: 宋体"><o:p></o:p></span></font></pre><pre style="BACKGROUND: #dddddd; TEXT-INDENT: 18pt; LINE-HEIGHT: 15pt; mso-char-indent-count: 2.0; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #993300; FONT-FAMILY: Verdana; mso-fareast-font-family: 新宋体; mso-bidi-font-family: 宋体">WSAEVENT event;</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体"> <span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>// </span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 新宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">定义事件</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #993300; FONT-FAMILY: Verdana; mso-fareast-font-family: 新宋体; mso-bidi-font-family: 宋体"><o:p></o:p></span></font></pre><pre style="BACKGROUND: #dddddd; TEXT-INDENT: 18pt; LINE-HEIGHT: 15pt; mso-char-indent-count: 2.0; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #993300; FONT-FAMILY: Verdana; mso-fareast-font-family: 新宋体; mso-bidi-font-family: 宋体">WSAOVERLAPPED </span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #993300; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体">AcceptOverlapped ; </span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体">// </span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 新宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">定义重叠结构</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #993300; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体"><o:p></o:p></span></font></pre><pre style="BACKGROUND: #dddddd; TEXT-INDENT: 18pt; LINE-HEIGHT: 15pt; mso-char-indent-count: 2.0; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #993300; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体">event = WSACreateEvent();<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体">// </span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 新宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">建立一个事件对象句柄</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #993300; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体"><o:p></o:p></span></font></pre><pre style="BACKGROUND: #dddddd; TEXT-INDENT: 17.65pt; LINE-HEIGHT: 15pt; mso-char-indent-count: 1.96; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #993300; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体">ZeroMemory(&amp;AcceptOverlapped, sizeof(WSAOVERLAPPED)); </span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体">// </span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 新宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">初始化重叠结构</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #993300; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体"><o:p></o:p></span></font></pre><pre style="BACKGROUND: #dddddd; TEXT-INDENT: 18pt; LINE-HEIGHT: 15pt; mso-char-indent-count: 2.0; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #993300; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体">AcceptOverlapped.hEvent = event; <span style="mso-spacerun: yes">&nbsp;&nbsp;</span><span style="mso-spacerun: yes">&nbsp;</span></span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体">// Done !</span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 新宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">！</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #993300; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体"><o:p></o:p></span></font></pre><pre style="BACKGROUND: #dddddd; TEXT-INDENT: 18pt; LINE-HEIGHT: 15pt; mso-char-indent-count: 2.0; mso-line-height-rule: exactly"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #993300; FONT-FAMILY: Verdana; mso-fareast-font-family: 新宋体"><o:p><font style="BACKGROUND-COLOR: #dddddd">&nbsp;</font></o:p></span></pre>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt 22.5pt; TEXT-INDENT: -18pt; mso-list: l0 level1 lfo4; tab-stops: list 22.5pt"><b style="mso-bidi-font-weight: normal"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #ff6600; FONT-FAMILY: Verdana; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><span style="mso-list: Ignore">2.<span style="FONT: 7pt &#39;Times New Roman&#39;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></b><b style="mso-bidi-font-weight: normal"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #ff6600; FONT-FAMILY: Verdana">WSARecv</span></b><b style="mso-bidi-font-weight: normal"><span style="FONT-SIZE: 9pt; COLOR: #ff6600; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">系列函数</span></b><b style="mso-bidi-font-weight: normal"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #ff6600; FONT-FAMILY: Verdana"><o:p></o:p></span></b>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt 22.5pt"><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">在重叠模型中，接收数据就要靠它了，它的参数也比</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">recv</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">要多，因为要用刀重叠结构嘛，它是这样定义的：</span><b style="mso-bidi-font-weight: normal"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #ff6600; FONT-FAMILY: Verdana"><o:p></o:p></span></b>
</p><pre style="BACKGROUND: #dddddd; LINE-HEIGHT: 12pt; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><b style="mso-bidi-font-weight: normal"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #ff6600; FONT-FAMILY: Verdana"><span style="mso-spacerun: yes">&nbsp;</span><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><b><span lang="EN-US" style="FONT-SIZE: 8.5pt; COLOR: black; FONT-FAMILY: Verdana">int</span></b><span lang="EN-US" style="FONT-SIZE: 8.5pt; COLOR: black; FONT-FAMILY: Verdana"> <b>WSARecv(</b><o:p></o:p></span></font></pre><pre style="BACKGROUND: #dddddd; LINE-HEIGHT: 12pt; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span lang="EN-US" style="FONT-SIZE: 8.5pt; COLOR: black; FONT-FAMILY: Verdana"> <span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="mso-spacerun: yes">&nbsp;</span><b>SOCKET</b> <i><span style="mso-field-code: &#39; HYPERLINK &#39;&#39;&#39;"><span class="MsoHyperlink"><span style="COLOR: #0040ff; TEXT-DECORATION: none; text-underline: none"><u>s</u></span></span></span></i><b>,<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></b></span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-family: 宋体; mso-ansi-language: ZH-CN">// </span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana; mso-bidi-font-family: 宋体; mso-ansi-language: ZH-CN">当然是投递这个操作的套接字</span><b><span lang="EN-US" style="FONT-SIZE: 8.5pt; COLOR: black; FONT-FAMILY: Verdana"><o:p></o:p></span></b></font></pre><pre style="BACKGROUND: #dddddd; LINE-HEIGHT: 12pt; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span lang="EN-US" style="FONT-SIZE: 8.5pt; COLOR: black; FONT-FAMILY: Verdana"> <span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><b>LPWSABUF</b> <i><span style="mso-field-code: &#39; HYPERLINK &#39;&#39;&#39;"><span class="MsoHyperlink"><span style="COLOR: #0040ff; TEXT-DECORATION: none; text-underline: none"><u>lpBuffers</u></span></span></span></i><b>,<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></b></span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-family: 宋体; mso-ansi-language: ZH-CN">// </span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana; mso-bidi-font-family: 宋体; mso-ansi-language: ZH-CN">接收缓冲区，与</span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-family: 宋体; mso-ansi-language: ZH-CN">Recv</span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana; mso-bidi-font-family: 宋体; mso-ansi-language: ZH-CN">函数不同</span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-family: 宋体; mso-ansi-language: ZH-CN"><o:p></o:p></span></font></pre><pre style="BACKGROUND: #dddddd; TEXT-INDENT: 189pt; LINE-HEIGHT: 12pt; mso-char-indent-count: 21.0; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-family: 宋体; mso-ansi-language: ZH-CN">// </span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana; mso-bidi-font-family: 宋体; mso-ansi-language: ZH-CN">这里需要一个由</span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-family: 宋体; mso-ansi-language: ZH-CN">WSABUF</span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana; mso-bidi-font-family: 宋体; mso-ansi-language: ZH-CN">结构构成的数组</span><b><span lang="EN-US" style="FONT-SIZE: 8.5pt; COLOR: black; FONT-FAMILY: Verdana"><o:p></o:p></span></b></font></pre><pre style="BACKGROUND: #dddddd; TEXT-INDENT: 46.75pt; LINE-HEIGHT: 12pt; mso-char-indent-count: 5.5; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span lang="EN-US" style="FONT-SIZE: 8.5pt; COLOR: black; FONT-FAMILY: Verdana">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>DWORD</b> <i><span style="mso-field-code: &#39; HYPERLINK &#39;&#39;&#39;"><span class="MsoHyperlink"><span style="COLOR: #0040ff; TEXT-DECORATION: none; text-underline: none"><u>dwBufferCount</u></span></span></span></i><b>,<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></b></span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-family: 宋体; mso-ansi-language: ZH-CN">// </span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana; mso-bidi-font-family: 宋体; mso-ansi-language: ZH-CN">数组中</span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-family: 宋体; mso-ansi-language: ZH-CN">WSABUF</span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana; mso-bidi-font-family: 宋体; mso-ansi-language: ZH-CN">结构的数量</span><b><span lang="EN-US" style="FONT-SIZE: 8.5pt; COLOR: black; FONT-FAMILY: Verdana"><o:p></o:p></span></b></font></pre><pre style="BACKGROUND: #dddddd; TEXT-INDENT: 38.25pt; LINE-HEIGHT: 12pt; mso-char-indent-count: 4.5; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span lang="EN-US" style="FONT-SIZE: 8.5pt; COLOR: black; FONT-FAMILY: Verdana">&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; <span style="mso-spacerun: yes">&nbsp;</span><span style="mso-spacerun: yes">&nbsp;</span><b>LPDWORD</b> <i><span style="mso-field-code: &#39; HYPERLINK &#39;&#39;&#39;"><span class="MsoHyperlink"><span style="COLOR: #0040ff; TEXT-DECORATION: none; text-underline: none"><u>lpNumberOfBytesRecvd</u></span></span></span></i><b>,<span style="mso-spacerun: yes">&nbsp; </span></b></span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-family: 宋体; mso-ansi-language: ZH-CN">// </span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana; mso-bidi-font-family: 宋体; mso-ansi-language: ZH-CN">如果接收操作立即完成，这里会返回函数调用</span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-family: 宋体; mso-ansi-language: ZH-CN"><o:p></o:p></span></font></pre><pre style="BACKGROUND: #dddddd; TEXT-INDENT: 216pt; LINE-HEIGHT: 12pt; mso-char-indent-count: 24.0; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-family: 宋体; mso-ansi-language: ZH-CN">// </span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana; mso-bidi-font-family: 宋体; mso-ansi-language: ZH-CN">所接收到的字节数</span><b><span lang="EN-US" style="FONT-SIZE: 8.5pt; COLOR: black; FONT-FAMILY: Verdana"><o:p></o:p></span></b></font></pre><pre style="BACKGROUND: #dddddd; TEXT-INDENT: 42.5pt; LINE-HEIGHT: 12pt; mso-char-indent-count: 5.0; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span lang="EN-US" style="FONT-SIZE: 8.5pt; COLOR: black; FONT-FAMILY: Verdana"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>LPDWORD</b> <i><span style="mso-field-code: &#39; HYPERLINK &#39;&#39;&#39;"><span class="MsoHyperlink"><span style="COLOR: #0040ff; TEXT-DECORATION: none; text-underline: none"><u>lpFlags</u></span></span></span></i><b>,<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></b></span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-family: 宋体; mso-ansi-language: ZH-CN">// </span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana; mso-bidi-font-family: 宋体; mso-ansi-language: ZH-CN">说来话长了，我们这里设置为</span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-family: 宋体; mso-ansi-language: ZH-CN">0 </span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana; mso-bidi-font-family: 宋体; mso-ansi-language: ZH-CN">即可</span><b><span lang="EN-US" style="FONT-SIZE: 8.5pt; COLOR: black; FONT-FAMILY: Verdana"><o:p></o:p></span></b></font></pre><pre style="BACKGROUND: #dddddd; TEXT-INDENT: 42.5pt; LINE-HEIGHT: 12pt; mso-char-indent-count: 5.0; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span lang="EN-US" style="FONT-SIZE: 8.5pt; COLOR: black; FONT-FAMILY: Verdana"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>LPWSAOVERLAPPED</b> <i><span style="mso-field-code: &#39; HYPERLINK &#39;&#39;&#39;"><span class="MsoHyperlink"><span style="COLOR: #0040ff; TEXT-DECORATION: none; text-underline: none"><u>lpOverlapped</u></span></span></span></i><b>, </b></span><b><span lang="EN-US" style="FONT-SIZE: 8.5pt; COLOR: green; FONT-FAMILY: Verdana"><span style="mso-spacerun: yes">&nbsp;</span></span></b><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-family: 宋体; mso-ansi-language: ZH-CN">// </span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana; mso-bidi-font-family: 宋体; mso-ansi-language: ZH-CN">“绑定”的重叠结构</span><b><span lang="EN-US" style="FONT-SIZE: 8.5pt; COLOR: black; FONT-FAMILY: Verdana"><o:p></o:p></span></b></font></pre><pre style="BACKGROUND: #dddddd; TEXT-INDENT: 42.5pt; LINE-HEIGHT: 12pt; mso-char-indent-count: 5.0; mso-line-height-rule: exactly"><span lang="EN-US" style="FONT-SIZE: 8.5pt; COLOR: black; FONT-FAMILY: Verdana"><font style="BACKGROUND-COLOR: #dddddd"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>LPWSAOVERLAPPED_COMPLETION_ROUTINE</b> <i><u><span style="mso-field-code: &#39; HYPERLINK &#39;&#39;&#39;"><span class="MsoHyperlink"><span style="COLOR: #0040ff; TEXT-DECORATION: none; text-underline: none">lpCompletionRoutine</span></span></span><o:p></o:p></u></i></font></span></pre><pre style="BACKGROUND: #dddddd; TEXT-INDENT: 42.5pt; LINE-HEIGHT: 12pt; mso-char-indent-count: 5.0; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><i><span lang="EN-US" style="FONT-SIZE: 8.5pt; COLOR: black; FONT-FAMILY: Verdana"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></i><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: 宋体; mso-bidi-font-style: italic"><span style="mso-spacerun: yes">&nbsp;</span></span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 宋体; mso-bidi-font-style: italic">// </span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 宋体; mso-bidi-font-style: italic">完成例程中将会用到的参数，我们这里设置为<span lang="EN-US"> NULL</span></span><b><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 宋体"><o:p></o:p></span></b></font></pre><pre style="BACKGROUND: #dddddd; TEXT-INDENT: 16.7pt; LINE-HEIGHT: 12pt; mso-char-indent-count: 1.96; mso-line-height-rule: exactly"><b><span lang="EN-US" style="FONT-SIZE: 8.5pt; COLOR: black; FONT-FAMILY: Verdana"><font style="BACKGROUND-COLOR: #dddddd">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);<o:p></o:p></font></span></b></pre><pre style="BACKGROUND: #dddddd; TEXT-INDENT: 17.7pt; LINE-HEIGHT: 15pt; mso-char-indent-count: 1.96; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><b><span style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">返回值：</span></b><b><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: Verdana"><o:p></o:p></span></b></font></pre><pre style="BACKGROUND: #dddddd; TEXT-INDENT: 17.65pt; LINE-HEIGHT: 15pt; mso-char-indent-count: 1.96; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold">WSA_IO_PENDING</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold"> </span><span style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: 宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">：</span><span style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold"> </span><span style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: 宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">最常见的返回值，这是说明我们的</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold">WSARecv</span><span style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: 宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">操作成功了，但是</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold"><o:p></o:p></span></font></pre><pre style="BACKGROUND: #dddddd; TEXT-INDENT: 17.65pt; LINE-HEIGHT: 15pt; mso-char-indent-count: 1.96; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>I/O</span><span style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: 宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">操作还没有完成，所以我们就需要绑定一个事件来通知我们操作何时完成</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold"><o:p></o:p></span></font></pre><pre style="BACKGROUND: #dddddd; TEXT-INDENT: 17.65pt; LINE-HEIGHT: 15pt; mso-char-indent-count: 1.96; mso-line-height-rule: exactly"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold"><o:p><font style="BACKGROUND-COLOR: #dddddd">&nbsp;</font></o:p></span></pre><pre style="BACKGROUND: #dddddd; TEXT-INDENT: 17.65pt; LINE-HEIGHT: 15pt; mso-char-indent-count: 1.96; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">举个例子：</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">(</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">变量的定义顺序和上面的说明的顺序是对应的，下同</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">)<o:p></o:p></span></font></pre><pre style="BACKGROUND: #dddddd; TEXT-INDENT: 17.65pt; LINE-HEIGHT: 15pt; mso-char-indent-count: 1.96; mso-line-height-rule: exactly"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #993300; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体"><font style="BACKGROUND-COLOR: #dddddd">SOCKET s;<o:p></o:p></font></span></pre><pre style="BACKGROUND: #dddddd; TEXT-INDENT: 17.65pt; LINE-HEIGHT: 15pt; mso-char-indent-count: 1.96; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #993300; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体">WSABUF DataBuf; <span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="mso-spacerun: yes">&nbsp;</span></span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体">// </span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 新宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">定义</span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-family: 宋体; mso-ansi-language: ZH-CN">WSABUF</span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana; mso-bidi-font-family: 宋体; mso-ansi-language: ZH-CN">结构的</span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 新宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">缓冲区</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #993300; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体"><o:p></o:p></span></font></pre><pre style="BACKGROUND: #dddddd; TEXT-INDENT: 17.65pt; LINE-HEIGHT: 15pt; mso-char-indent-count: 1.96; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体">// </span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 新宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">初始化一下</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体">DataBuf<o:p></o:p></span></font></pre><pre style="BACKGROUND: #dddddd; TEXT-INDENT: 17.65pt; LINE-HEIGHT: 15pt; mso-char-indent-count: 1.96; mso-line-height-rule: exactly"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #993300; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体"><font style="BACKGROUND-COLOR: #dddddd">#define DATA_BUFSIZE 5096<o:p></o:p></font></span></pre><pre style="BACKGROUND: #dddddd; TEXT-INDENT: 18pt; LINE-HEIGHT: 15pt; mso-char-indent-count: 2.0; mso-line-height-rule: exactly"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #993300; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体"><font style="BACKGROUND-COLOR: #dddddd">char buffer[DATA_BUFSIZE];<o:p></o:p></font></span></pre><pre style="BACKGROUND: #dddddd; TEXT-INDENT: 17.65pt; LINE-HEIGHT: 15pt; mso-char-indent-count: 1.96; mso-line-height-rule: exactly"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #993300; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体"><font style="BACKGROUND-COLOR: #dddddd">ZeroMemory(buffer, DATA_BUFSIZE);<o:p></o:p></font></span></pre><pre style="BACKGROUND: #dddddd; TEXT-INDENT: 17.65pt; LINE-HEIGHT: 15pt; mso-char-indent-count: 1.96; mso-line-height-rule: exactly"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #993300; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体"><font style="BACKGROUND-COLOR: #dddddd">DataBuf.len = DATA_BUFSIZE;<o:p></o:p></font></span></pre><pre style="BACKGROUND: #dddddd; TEXT-INDENT: 17.65pt; LINE-HEIGHT: 15pt; mso-char-indent-count: 1.96; mso-line-height-rule: exactly"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #993300; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体"><font style="BACKGROUND-COLOR: #dddddd">DataBuf.buf = buffer;<o:p></o:p></font></span></pre><pre style="BACKGROUND: #dddddd; TEXT-INDENT: 17.65pt; LINE-HEIGHT: 15pt; mso-char-indent-count: 1.96; mso-line-height-rule: exactly"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #993300; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体"><font style="BACKGROUND-COLOR: #dddddd">DWORD dwBufferCount = 1, dwRecvBytes = 0, Flags = 0;<o:p></o:p></font></span></pre><pre style="BACKGROUND: #dddddd; TEXT-INDENT: 17.65pt; LINE-HEIGHT: 15pt; mso-char-indent-count: 1.96; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体">// </span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 新宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">建立需要的重叠结构</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体"><o:p></o:p></span></font></pre><pre style="BACKGROUND: #dddddd; TEXT-INDENT: 17.65pt; LINE-HEIGHT: 15pt; mso-char-indent-count: 1.96; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #993300; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体">WSAOVERLAPPED AcceptOverlapped ;</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体">// </span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 新宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">如果要处理多个操作，这里当然需要一个</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体"><o:p></o:p></span></font></pre><pre style="BACKGROUND: #dddddd; TEXT-INDENT: 193.15pt; LINE-HEIGHT: 15pt; mso-char-indent-count: 21.46; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体">// WSAOVERLAPPED</span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 新宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">数组</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体"><o:p></o:p></span></font></pre><pre style="BACKGROUND: #dddddd; TEXT-INDENT: 17.65pt; LINE-HEIGHT: 15pt; mso-char-indent-count: 1.96; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #993300; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体">WSAEVENT event;<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体">// </span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 新宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">如果要多个事件，这里当然也需要一个</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体">WSAEVENT</span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 新宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">数组</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体"><o:p></o:p></span></font></pre><pre style="BACKGROUND: #dddddd; MARGIN-LEFT: 121.5pt; TEXT-INDENT: -121.5pt; LINE-HEIGHT: 14pt; mso-char-indent-count: -13.5; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt; mso-fareast-font-family: 新宋体"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 新宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana; mso-bidi-font-size: 12.0pt">需要注意的是可能一个</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt; mso-fareast-font-family: 新宋体">SOCKET</span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 新宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana; mso-bidi-font-size: 12.0pt">同时会有一个以上的重叠请求，</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt; mso-fareast-font-family: 新宋体"><o:p></o:p></span></font></pre><pre style="BACKGROUND: #dddddd; TEXT-INDENT: 126pt; LINE-HEIGHT: 14pt; mso-char-indent-count: 14.0; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt; mso-fareast-font-family: 新宋体">//<span style="mso-spacerun: yes">&nbsp; </span></span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 新宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana; mso-bidi-font-size: 12.0pt">也就会对应一个以上的</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt; mso-fareast-font-family: 新宋体">WSAEVENT<o:p></o:p></span></font></pre><pre style="BACKGROUND: #dddddd; TEXT-INDENT: 17.65pt; LINE-HEIGHT: 15pt; mso-char-indent-count: 1.96; mso-line-height-rule: exactly"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #993300; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体"><font style="BACKGROUND-COLOR: #dddddd">Event = WSACreateEvent();<o:p></o:p></font></span></pre><pre style="BACKGROUND: #dddddd; TEXT-INDENT: 17.65pt; LINE-HEIGHT: 15pt; mso-char-indent-count: 1.96; mso-line-height-rule: exactly"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #993300; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体"><font style="BACKGROUND-COLOR: #dddddd">ZeroMemory(&amp;AcceptOverlapped, sizeof(WSAOVERLAPPED));<o:p></o:p></font></span></pre><pre style="BACKGROUND: #dddddd; TEXT-INDENT: 17.65pt; LINE-HEIGHT: 15pt; mso-char-indent-count: 1.96; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #993300; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体">AcceptOverlapped.hEvent = event;<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体"><span style="mso-spacerun: yes">&nbsp;</span>// </span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 新宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">关键的一步，把事件句柄“绑定”到重叠结构上</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #993300; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体"><o:p></o:p></span></font></pre><pre style="BACKGROUND: #dddddd; TEXT-INDENT: 17.65pt; LINE-HEIGHT: 15pt; mso-char-indent-count: 1.96; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体">// </span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 新宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">作了这么多工作，终于可以使用</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体">WSARecv</span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 新宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">来把我们的请求投递到重叠结构上了，呼。。。。</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体"><o:p></o:p></span></font></pre><pre style="BACKGROUND: #dddddd; TEXT-INDENT: 17.65pt; LINE-HEIGHT: 15pt; mso-char-indent-count: 1.96; mso-line-height-rule: exactly"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #993300; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体"><font style="BACKGROUND-COLOR: #dddddd">WSARecv(s, &amp;DataBuf, dwBufferCount, &amp;dwRecvBytes, <o:p></o:p></font></span></pre><pre style="BACKGROUND: #dddddd; TEXT-INDENT: 152.65pt; LINE-HEIGHT: 15pt; mso-char-indent-count: 16.96; mso-line-height-rule: exactly"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #993300; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体"><font style="BACKGROUND-COLOR: #dddddd">&amp;Flags, &amp;AcceptOverlapped, NULL);<o:p></o:p></font></span></pre><pre style="BACKGROUND: #dddddd; TEXT-INDENT: 17.65pt; LINE-HEIGHT: 15pt; mso-char-indent-count: 1.96; mso-line-height-rule: exactly"><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-bidi-font-weight: bold"><font style="BACKGROUND-COLOR: #dddddd">其他的函数我这里就不一一介绍了，因为我们毕竟还有<span lang="EN-US">MSDN</span>这么个好帮手，而且在讲后面的完成例程和完成端口的时候我还会讲到一些<span lang="EN-US"> ^_^<o:p></o:p></span></font></span></pre><pre style="BACKGROUND: #dddddd; TEXT-INDENT: 17.65pt; LINE-HEIGHT: 12pt; mso-char-indent-count: 1.96; mso-line-height-rule: exactly"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: Verdana"><o:p><font style="BACKGROUND-COLOR: #dddddd">&nbsp;</font></o:p></span></pre>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt 22.5pt; TEXT-INDENT: -18pt; mso-list: l0 level1 lfo4; tab-stops: list 22.5pt"><b style="mso-bidi-font-weight: normal"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #ff6600; FONT-FAMILY: Verdana; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><span style="mso-list: Ignore">3.<span style="FONT: 7pt &#39;Times New Roman&#39;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></b><b style="mso-bidi-font-weight: normal"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #ff6600; FONT-FAMILY: Verdana">WSAWaitForMultipleEvents</span></b><b style="mso-bidi-font-weight: normal"><span style="FONT-SIZE: 9pt; COLOR: #ff6600; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">函数</span></b><b style="mso-bidi-font-weight: normal"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #ff6600; FONT-FAMILY: Verdana"><o:p></o:p></span></b>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; TEXT-INDENT: 18pt; mso-char-indent-count: 2.0"><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">熟悉</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">WSAEventSelect</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">模型的朋友对这个函数肯定不会陌生，不对，其实大家都不应该陌生，这个函数与线程中常用的</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">WaitForMultipleObjects</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">函数有些地方还是比较像的，因为都是在等待某个事件的触发嘛。</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana"><o:p></o:p></span>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; TEXT-INDENT: 18pt; mso-char-indent-count: 2.0"><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">因为我们需要事件来通知我们重叠操作的完成，所以自然需要这个等待事件的函数与之配套。</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana"><o:p></o:p></span>
</p><pre style="BACKGROUND: #dddddd; LINE-HEIGHT: 14pt; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><b><span lang="EN-US" style="FONT-SIZE: 8.5pt; COLOR: black; FONT-FAMILY: Verdana">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DWORD</span></b><span lang="EN-US" style="FONT-SIZE: 8.5pt; COLOR: black; FONT-FAMILY: Verdana"> <b>WSAWaitForMultipleEvents(</b><o:p></o:p></span></font></pre><pre style="BACKGROUND: #dddddd; LINE-HEIGHT: 14pt; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span lang="EN-US" style="FONT-SIZE: 8.5pt; COLOR: black; FONT-FAMILY: Verdana"><span style="mso-spacerun: yes">&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DWORD</b> <i><span style="mso-field-code: &#39; HYPERLINK &#39;&#39;&#39;"><span class="MsoHyperlink"><span style="COLOR: #0040ff; TEXT-DECORATION: none; text-underline: none"><u>cEvents</u></span></span></span></i><b>,</b></span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体"> <span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="mso-spacerun: yes">&nbsp;</span>// </span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 新宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">等候事件的总数量</span><b><span lang="EN-US" style="FONT-SIZE: 8.5pt; COLOR: black; FONT-FAMILY: Verdana"><o:p></o:p></span></b></font></pre><pre style="BACKGROUND: #dddddd; LINE-HEIGHT: 14pt; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span lang="EN-US" style="FONT-SIZE: 8.5pt; COLOR: black; FONT-FAMILY: Verdana"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>const WSAEVENT*</b> <i><span style="mso-field-code: &#39; HYPERLINK &#39;&#39;&#39;"><span class="MsoHyperlink"><span style="COLOR: #0040ff; TEXT-DECORATION: none; text-underline: none"><u>lphEvents</u></span></span></span></i><b>,<span style="mso-spacerun: yes">&nbsp; </span><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></b></span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体">// </span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 新宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">事件数组的指针</span><b><span lang="EN-US" style="FONT-SIZE: 8.5pt; COLOR: black; FONT-FAMILY: Verdana"><o:p></o:p></span></b></font></pre><pre style="BACKGROUND: #dddddd; LINE-HEIGHT: 14pt; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span lang="EN-US" style="FONT-SIZE: 8.5pt; COLOR: black; FONT-FAMILY: Verdana"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>BOOL</b> <i><span style="mso-field-code: &#39; HYPERLINK &#39;&#39;&#39;"><span class="MsoHyperlink"><span style="COLOR: #0040ff; TEXT-DECORATION: none; text-underline: none"><u>fWaitAll</u></span></span></span></i><b>,<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></b></span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体">// </span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 新宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">这个要多说两句：</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体"><o:p></o:p></span></font></pre><pre style="BACKGROUND: #dddddd; LINE-HEIGHT: 14pt; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 新宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">如果设置为</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体"> TRUE</span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 新宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">，则事件数组中所有事件被传信的时候函数才会返回</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体"><o:p></o:p></span></font></pre><pre style="BACKGROUND: #dddddd; LINE-HEIGHT: 14pt; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>// FALSE</span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 新宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">则任何一个事件被传信函数都要返回</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体"><o:p></o:p></span></font></pre><pre style="BACKGROUND: #dddddd; LINE-HEIGHT: 14pt; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 新宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">我们这里肯定是要设置为</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体">FALSE</span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 新宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">的</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体"><o:p></o:p></span></font></pre><pre style="BACKGROUND: #dddddd; LINE-HEIGHT: 14pt; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span lang="EN-US" style="FONT-SIZE: 8.5pt; COLOR: black; FONT-FAMILY: Verdana"><span style="mso-spacerun: yes">&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><b>DWORD</b> <i><span style="mso-field-code: &#39; HYPERLINK &#39;&#39;&#39;"><span class="MsoHyperlink"><span style="COLOR: #0040ff; TEXT-DECORATION: none; text-underline: none"><u>dwTimeout</u></span></span></span></i><b>,<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span></b></span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体">// </span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 新宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">超时时间，如果超时，函数会返回</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体"> WSA_WAIT_TIMEOUT<o:p></o:p></span></font></pre><pre style="BACKGROUND: #dddddd; TEXT-INDENT: 112.5pt; LINE-HEIGHT: 14pt; mso-char-indent-count: 12.5; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// </span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 新宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">如果设置为</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体">0</span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 新宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">，函数会立即返回</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体"><o:p></o:p></span></font></pre><pre style="BACKGROUND: #dddddd; TEXT-INDENT: 112.5pt; LINE-HEIGHT: 14pt; mso-char-indent-count: 12.5; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// </span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 新宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">如果设置为</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体"> WSA_INFINITE</span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 新宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">只有在某一个事件被传信后才会返回</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体"><o:p></o:p></span></font></pre><pre style="BACKGROUND: #dddddd; TEXT-INDENT: 112.5pt; LINE-HEIGHT: 14pt; mso-char-indent-count: 12.5; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// </span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 新宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">在这里不建议设置为</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体">WSA_INFINITE</span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 新宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">，因为。。。后面再讲吧</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体">..-_-b</span><b><span lang="EN-US" style="FONT-SIZE: 8.5pt; COLOR: black; FONT-FAMILY: Verdana"><o:p></o:p></span></b></font></pre><pre style="BACKGROUND: #dddddd; LINE-HEIGHT: 14pt; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span lang="EN-US" style="FONT-SIZE: 8.5pt; COLOR: black; FONT-FAMILY: Verdana"><span style="mso-spacerun: yes">&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><b>BOOL</b> <i><span style="mso-field-code: &#39; HYPERLINK &#39;&#39;&#39;"><span class="MsoHyperlink"><span style="COLOR: #0040ff; TEXT-DECORATION: none; text-underline: none"><u>fAlertable</u></span></span></span><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></i></span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体">// </span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 新宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">在完成例程中会用到这个参数，这里我们先设置为</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体">FALSE</span><b><span lang="EN-US" style="FONT-SIZE: 8.5pt; COLOR: black; FONT-FAMILY: Verdana"><o:p></o:p></span></b></font></pre><pre style="BACKGROUND: #dddddd; LINE-HEIGHT: 14pt; mso-line-height-rule: exactly"><b><span lang="EN-US" style="FONT-SIZE: 8.5pt; COLOR: black; FONT-FAMILY: Verdana"><font style="BACKGROUND-COLOR: #dddddd">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);<o:p></o:p></font></span></b></pre><pre style="BACKGROUND: #dddddd; LINE-HEIGHT: 15pt; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><b><span style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">返回值：</span></b><b><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: Verdana"><o:p></o:p></span></b></font></pre><pre style="BACKGROUND: #dddddd; LINE-HEIGHT: 14pt; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold">&nbsp;&nbsp;&nbsp;&nbsp;WSA_WAIT_TIMEOUT</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold"> </span><span style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: 宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">：最常见的返回值，我们需要做的就是继续</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold">Wait<o:p></o:p></span></font></pre><pre style="BACKGROUND: #dddddd; LINE-HEIGHT: 14pt; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold">&nbsp;&nbsp;&nbsp;&nbsp;WSA_WAIT_FAILED </span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">：</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold"> </span><span style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: 宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">出现了错误，请检查</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: Verdana; mso-bidi-font-style: italic"><span style="mso-field-code: &#39; HYPERLINK &#39;&#39;&#39;"><span class="MsoHyperlink"><span style="COLOR: black; TEXT-DECORATION: none; text-underline: none"><u>cEvents</u></span></span></span></span><span style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana; mso-bidi-font-style: italic">和</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: Verdana; mso-bidi-font-style: italic"><span style="mso-field-code: &#39; HYPERLINK &#39;&#39;&#39;"><span class="MsoHyperlink"><span style="COLOR: black; TEXT-DECORATION: none; text-underline: none"><u>lphEvents</u></span></span></span></span><span style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana; mso-bidi-font-style: italic">两个参数是否有效</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: Verdana; mso-bidi-font-style: italic"><o:p></o:p></span></font></pre><pre style="BACKGROUND: #dddddd; LINE-HEIGHT: 14pt; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana; mso-bidi-font-style: italic">如果事件数组中有某一个事件被传信了，函数会返回这个事件的索引值，但是这个索引值需要减去预定义值</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana; mso-bidi-font-style: italic"> WSA_WAIT_EVENT_0</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana; mso-bidi-font-style: italic">才是这个事件在事件数组中的位置。</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana; mso-bidi-font-style: italic"><o:p></o:p></span></font></pre><pre style="BACKGROUND: #dddddd; LINE-HEIGHT: 14pt; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana; mso-bidi-font-style: italic">具体的例子就先不在这里举了，后面还会讲到</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana; mso-bidi-font-style: italic"><o:p></o:p></span></font></pre><pre style="BACKGROUND: #dddddd; MARGIN-LEFT: 22.5pt; TEXT-INDENT: -22.5pt; LINE-HEIGHT: 17pt; mso-char-indent-count: -2.5; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span style="FONT-SIZE: 9pt; COLOR: red; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana; mso-bidi-font-style: italic">注意：</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">WSAWaitForMultipleEvents</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">函数只能支持由</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">WSA_MAXIMUM_WAIT_EVENTS</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">对象定义的一个最大值，是</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana"> </span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: red; FONT-FAMILY: Verdana">64</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">，就是说</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">WSAWaitForMultipleEvents</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">只能等待</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: red; FONT-FAMILY: Verdana">64</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">个事件，如果想同时等待多于</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: red; FONT-FAMILY: Verdana">64</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">个事件，就要</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana"> </span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">创建额外的工作者线程，就不得不去管理一个线程池，这一点就不如下一篇要讲到的完成例程模型了。</span><span lang="EN-US" style="FONT-SIZE: 8.5pt; COLOR: blue; FONT-FAMILY: Verdana"><o:p></o:p></span></font></pre>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt 4.5pt; LINE-HEIGHT: 17pt; mso-line-height-rule: exactly"><b style="mso-bidi-font-weight: normal"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #ff6600; FONT-FAMILY: Verdana"><o:p>&nbsp;</o:p></span></b>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt 22.5pt; TEXT-INDENT: -18pt; LINE-HEIGHT: 17pt; mso-line-height-rule: exactly; mso-list: l0 level1 lfo4; tab-stops: list 22.5pt"><b style="mso-bidi-font-weight: normal"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #ff6600; FONT-FAMILY: Verdana; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><span style="mso-list: Ignore">4.<span style="FONT: 7pt &#39;Times New Roman&#39;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></b><b style="mso-bidi-font-weight: normal"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #ff6600; FONT-FAMILY: Verdana">WSAGetOverlappedResult</span></b><b style="mso-bidi-font-weight: normal"><span style="FONT-SIZE: 9pt; COLOR: #ff6600; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">函数</span></b><b style="mso-bidi-font-weight: normal"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: #ff6600; FONT-FAMILY: Verdana"><o:p></o:p></span></b>
</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt 18.05pt; TEXT-INDENT: 18pt; LINE-HEIGHT: 17pt; mso-char-indent-count: 2.0; mso-line-height-rule: exactly; mso-para-margin-left: 1.72gd"><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">既然我们可以通过</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">WSAWaitForMultipleEvents</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">函数来得到重叠操作完成的通知，那么我们自然也需要一个函数来查询一下重叠操作的结果，定义如下</span><b style="mso-bidi-font-weight: normal"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: fuchsia; FONT-FAMILY: Verdana"><o:p></o:p></span></b>
</p><pre style="BACKGROUND: #dddddd; LINE-HEIGHT: 14pt; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BOOL</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: Verdana"> <span style="mso-bidi-font-weight: bold">WSAGetOverlappedResult(</span><o:p></o:p></span></font></pre><pre style="BACKGROUND: #dddddd; LINE-HEIGHT: 14pt; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: Verdana"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-bidi-font-weight: bold">SOCKET</span> </span><i><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana"><span style="mso-field-code: &#39; HYPERLINK &#39;&#39;&#39;"><span class="MsoHyperlink"><span style="COLOR: blue; TEXT-DECORATION: none; text-underline: none"><u>s</u></span></span></span></span></i><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold">,<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体">// SOCKET</span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 新宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">，不用说了</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold"><o:p></o:p></span></font></pre><pre style="BACKGROUND: #dddddd; LINE-HEIGHT: 14pt; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: Verdana"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-bidi-font-weight: bold">LPWSAOVERLAPPED</span> </span><i><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana"><span style="mso-field-code: &#39; HYPERLINK &#39;&#39;&#39;"><span class="MsoHyperlink"><span style="COLOR: blue; TEXT-DECORATION: none; text-underline: none"><u>lpOverlapped</u></span></span></span></span></i><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold">,<span style="mso-spacerun: yes">&nbsp; </span></span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体">// </span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 新宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">这里是我们想要查询结果的那个重叠结构的指针</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold"><o:p></o:p></span></font></pre><pre style="BACKGROUND: #dddddd; LINE-HEIGHT: 14pt; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: Verdana"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-bidi-font-weight: bold">LPDWORD</span> </span><i><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana"><span style="mso-field-code: &#39; HYPERLINK &#39;&#39;&#39;"><span class="MsoHyperlink"><span style="COLOR: blue; TEXT-DECORATION: none; text-underline: none"><u>lpcbTransfer</u></span></span></span></span></i><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold">,<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体">// </span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 新宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">本次重叠操作的实际接收</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体">(</span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 新宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">或发送</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体">)</span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 新宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">的字节数</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold"><o:p></o:p></span></font></pre><pre style="BACKGROUND: #dddddd; LINE-HEIGHT: 14pt; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: Verdana"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-bidi-font-weight: bold">BOOL</span></span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana"> </span><i><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana"><span style="mso-field-code: &#39; HYPERLINK &#39;&#39;&#39;"><span class="MsoHyperlink"><span style="COLOR: blue; TEXT-DECORATION: none; text-underline: none"><u>fWait</u></span></span></span></span></i><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold">,<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体">// </span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 新宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">设置为</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体">TRUE</span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 新宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">，除非重叠操作完成，否则函数不会返回</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体"><o:p></o:p></span></font></pre><pre style="BACKGROUND: #dddddd; LINE-HEIGHT: 14pt; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 新宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">设置</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体">FALSE</span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 新宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">，而且操作仍处于挂起状态，那么函数就会返回</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体">FALSE<o:p></o:p></span></font></pre><pre style="BACKGROUND: #dddddd; LINE-HEIGHT: 14pt; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 新宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">错误为</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体">WSA_IO_INCOMPLETE<o:p></o:p></span></font></pre><pre style="BACKGROUND: #dddddd; LINE-HEIGHT: 14pt; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 新宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">不过因为我们是等待事件传信来通知我们操作完成，所以我们这里设</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体"><o:p></o:p></span></font></pre><pre style="BACKGROUND: #dddddd; TEXT-INDENT: 135pt; LINE-HEIGHT: 14pt; mso-char-indent-count: 15.0; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// </span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 新宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">置成什么都没有作用</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体">…..-_-b<span style="mso-spacerun: yes">&nbsp; </span></span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 新宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">别仍鸡蛋啊，我也想说得清楚一些</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体">…</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold"><o:p></o:p></span></font></pre><pre style="BACKGROUND: #dddddd; LINE-HEIGHT: 14pt; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: Verdana"><span style="mso-spacerun: yes">&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="mso-bidi-font-weight: bold">LPDWORD</span></span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana"> </span><i><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana"><span style="mso-field-code: &#39; HYPERLINK &#39;&#39;&#39;"><span class="MsoHyperlink"><span style="COLOR: blue; TEXT-DECORATION: none; text-underline: none"><u>lpdwFlags</u></span></span></span><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></i><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体">// </span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 新宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">指向</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold; mso-fareast-font-family: 新宋体">DWORD</span><span style="FONT-SIZE: 9pt; COLOR: green; FONT-FAMILY: 新宋体; mso-bidi-font-weight: bold; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">的指针，负责接收结果标志</span><i style="mso-bidi-font-style: normal"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold"><o:p></o:p></span></i></font></pre><pre style="BACKGROUND: #dddddd; LINE-HEIGHT: 14pt; mso-line-height-rule: exactly"><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold"><font style="BACKGROUND-COLOR: #dddddd">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);<o:p></o:p></font></span></pre><pre style="BACKGROUND: #dddddd; LINE-HEIGHT: 17pt; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">这个函数没什么难的，这里我们也不需要去关注它的返回值，直接把参数填好调用就可以了，这里就先不举例了</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana"><o:p></o:p></span></font></pre><pre style="BACKGROUND: #dddddd; LINE-HEIGHT: 17pt; mso-line-height-rule: exactly"><font style="BACKGROUND-COLOR: #dddddd"><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">唯一需要注意一下的就是如果</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana; mso-bidi-font-weight: bold">WSAGetOverlappedResult</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">完成以后，第三个参数返回是</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana"> 0 </span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">，则说明通信对方已经关闭连接，我们这边的</span><span lang="EN-US" style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: Verdana">SOCKET, Event</span><span style="FONT-SIZE: 9pt; COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">之类的也就可以关闭了。</span></font></pre>
    <div class="source_link_bottom"><a href="http://www.cnblogs.com/xw885/articles/129726.html">》点击查看原文...</a></div>
    <div class="a4_area"><a href="http://job.cnblogs.com/">程序员找工作，就在博客园</a></div>
</div>			
</div>
<script type="text/javascript" src="./手把手教你玩转SOCKET模型之重叠I O篇（上）_files/google_service.js">
</script>
<script type="text/javascript">
    try {
        GS_googleAddAdSenseService("ca-pub-4210569241504288");
        GS_googleEnableAllServices();
    } catch (e) { }
</script><script src="./手把手教你玩转SOCKET模型之重叠I O篇（上）_files/google_ads.js"></script>
<script type="text/javascript">
    try {
        GA_googleAddSlot("ca-pub-4210569241504288", "cnblogs_archive_top");
        GA_googleAddSlot("ca-pub-4210569241504288", "cnblogs_archive_bottom");
    } catch (e) { }
</script>
<script type="text/javascript">
    try {
        GA_googleFetchAds();
    } catch (e) { }
</script>
<div id="ad_top">
<script type="text/javascript">
    try {
        GA_googleFillSlot("cnblogs_archive_top");
    } catch (e) { }
</script><script src="./手把手教你玩转SOCKET模型之重叠I O篇（上）_files/ads"></script><div id="google_ads_div_cnblogs_archive_top">
<ins style="width: 728px; height: 90px; border-top-width: 0px; border-right-width: 0px; border-bottom-width: 0px; border-left-width: 0px; border-style: initial; border-color: initial; display: inline-table; position: relative; "><ins style="width: 728px; height: 90px; border-top-width: 0px; border-right-width: 0px; border-bottom-width: 0px; border-left-width: 0px; border-style: initial; border-color: initial; display: block; position: relative; "><iframe id="google_ads_iframe_cnblogs_archive_top" name="google_ads_iframe_cnblogs_archive_top" width="728" height="90" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" style="border-top-width: 0px; border-right-width: 0px; border-bottom-width: 0px; border-left-width: 0px; border-style: initial; border-color: initial; position: absolute; top: 0px; left: 0px; "></iframe></ins></ins></div>
<script>GA_googleCreateDomIframe('google_ads_div_cnblogs_archive_top' ,'cnblogs_archive_top');</script>
</div>
<div id="ad_bottom">
<script type="text/javascript">
    try {
        GA_googleFillSlot("cnblogs_archive_bottom");
    } catch (e) { }
</script><script src="./手把手教你玩转SOCKET模型之重叠I O篇（上）_files/ads(1)"></script><div id="google_ads_div_cnblogs_archive_bottom">
<ins style="width: 728px; height: 90px; border-top-width: 0px; border-right-width: 0px; border-bottom-width: 0px; border-left-width: 0px; border-style: initial; border-color: initial; display: inline-table; position: relative; "><ins style="width: 728px; height: 90px; border-top-width: 0px; border-right-width: 0px; border-bottom-width: 0px; border-left-width: 0px; border-style: initial; border-color: initial; display: block; position: relative; "><iframe id="google_ads_iframe_cnblogs_archive_bottom" name="google_ads_iframe_cnblogs_archive_bottom" width="728" height="90" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" style="border-top-width: 0px; border-right-width: 0px; border-bottom-width: 0px; border-left-width: 0px; border-style: initial; border-color: initial; position: absolute; top: 0px; left: 0px; "></iframe></ins></ins></div>
<script>GA_googleCreateDomIframe('google_ads_div_cnblogs_archive_bottom' ,'cnblogs_archive_bottom');</script>
</div>
<script type="text/javascript" src="./手把手教你玩转SOCKET模型之重叠I O篇（上）_files/shCore.js"></script>
<script type="text/javascript" src="./手把手教你玩转SOCKET模型之重叠I O篇（上）_files/shLanguage.js"></script>
<script type="text/javascript">
    try {
        SyntaxHighlighter.config.clipboardSwf = 'http://common.cnblogs.com/flash/clipboard.swf';
        SyntaxHighlighter.all();
    } catch (e) { }
</script> 
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F02fd5f9634457187877fa1d896d9e100' type='text/javascript'%3E%3C/script%3E"));
</script><script src="./手把手教你玩转SOCKET模型之重叠I O篇（上）_files/h.js" type="text/javascript"></script>
<span style="display:none"><script src="./手把手教你玩转SOCKET模型之重叠I O篇（上）_files/stat.php" type="text/javascript"></script><a href="http://www.cnzz.com/stat/website.php?web_id=2325484" target="_blank" title="站长统计">站长统计</a><img src="./手把手教你玩转SOCKET模型之重叠I O篇（上）_files/stat.htm" border="0" width="0" height="0"></span> 



</body></html>